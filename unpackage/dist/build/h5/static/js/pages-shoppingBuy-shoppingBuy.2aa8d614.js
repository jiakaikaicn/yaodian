(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-shoppingBuy-shoppingBuy"],{"0ccb":function(t,e,i){var a=i("50c4"),n=i("1148"),s=i("1d80"),o=Math.ceil,u=function(t){return function(e,i,u){var r,l,c=String(s(e)),d=c.length,h=void 0===u?" ":String(u),p=a(i);return p<=d||""==h?c:(r=p-d,l=n.call(h,o(r/h.length)),l.length>r&&(l=l.slice(0,r)),t?c+l:l+c)}};t.exports={start:u(!1),end:u(!0)}},"0d7a":function(t,e,i){var a=i("24fb");e=a(!1),e.push([t.i,"[data-v-59229be8] .uni-group{flex-wrap:nowrap}[data-v-59229be8] .uni-group .uni-button{margin-left:0;margin-right:10px!important}[data-v-59229be8] .uni-popup__wrapper{background:#fff!important}.text[data-v-59229be8]{font-size:28px;margin-top:25px;color:#5479fd}[data-v-59229be8] .iconfont{font-size:80px!important;color:#128b1a!important;width:80px;height:80px}.grid-dynamic-box[data-v-59229be8]{margin-bottom:15px}.grid-item-box[data-v-59229be8]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:15px 0}.grid-item-box-row[data-v-59229be8]{flex:1;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:15px 0}.grid-dot[data-v-59229be8]{position:absolute;top:5px;right:15px}@media screen and (min-width:768px) and (max-width:1425px){.swiper[data-v-59229be8]{height:630px}}@media screen and (min-width:1425px){.swiper[data-v-59229be8]{height:830px}}.zhifuPopupDiv[data-v-59229be8]{padding:20px 30px}.zhifuPopupDiv .title[data-v-59229be8]{padding:10px 0;border-bottom:1px solid #ccc;margin-bottom:10px;font-weight:600;font-size:22px}.zhifuPopupDiv .formDataDiv[data-v-59229be8]{padding:0 20px}",""]),t.exports=e},1148:function(t,e,i){"use strict";var a=i("a691"),n=i("1d80");t.exports="".repeat||function(t){var e=String(n(this)),i="",s=a(t);if(s<0||s==1/0)throw RangeError("Wrong number of repetitions");for(;s>0;(s>>>=1)&&(e+=e))1&s&&(i+=e);return i}},1469:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return a}));var a={uniPopup:i("4f6b").default,uniTable:i("9e02").default,uniTr:i("158c").default,uniTh:i("1bb9").default,uniTd:i("1cbc").default,uniPagination:i("41c2").default,uniPopupDialog:i("01fe").default,uniGrid:i("d064").default,uniGridItem:i("c531").default,uniForms:i("c032").default,uniFormsItem:i("356a").default,uniEasyinput:i("f17f").default},n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("v-uni-view",{staticClass:"uni-header"},[i("v-uni-view",{staticClass:"uni-group hide-on-phone"},[i("v-uni-view",{staticClass:"uni-title"},[t._v("销售")])],1)],1),i("v-uni-view",[i("v-uni-view",{staticClass:"uni-group"},[i("v-uni-input",{staticClass:"uni-search",attrs:{type:"text",placeholder:"请输入商品名称"},on:{confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.searchFn.apply(void 0,arguments)}},model:{value:t.searchVal,callback:function(e){t.searchVal=e},expression:"searchVal"}}),i("v-uni-button",{staticClass:"uni-button",attrs:{type:"default",size:"mini"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.searchFn.apply(void 0,arguments)}}},[t._v(t._s(t.$t("common.button.search")))])],1)],1),i("uni-popup",{ref:"popup"},[i("v-uni-view",{staticClass:"uni-container"},[i("uni-table",{attrs:{loading:t.loading,border:!0,stripe:!0,type:"selection",emptyText:t.$t("common.empty")},on:{"selection-change":function(e){arguments[0]=e=t.$handleEvent(e),t.selectionChange.apply(void 0,arguments)}}},[i("uni-tr",[i("uni-th",{attrs:{width:"40",align:"center"}},[t._v("ID")]),i("uni-th",{attrs:{width:"150",align:"center"}},[t._v("药名")]),i("uni-th",{attrs:{width:"80",align:"center"}},[t._v("库存")]),i("uni-th",{attrs:{width:"80",align:"center"}},[t._v("单位")]),i("uni-th",{attrs:{width:"120",align:"center"}},[t._v("销售价")])],1),t._l(t.popupTableData,(function(e,a){return i("uni-tr",{key:a},[i("uni-td",{attrs:{align:"center"}},[t._v(t._s(e._id))]),i("uni-td",{attrs:{align:"center"}},[t._v(t._s(e.name))]),i("uni-td",{attrs:{align:"center"}},[t._v(t._s(e.shuliang))]),i("uni-td",{attrs:{align:"center"}},[t._v(t._s(e.danwei))]),i("uni-td",{attrs:{align:"center"}},[t._v(t._s(e.xiaoshou_jia))])],1)}))],2),i("v-uni-view",{staticClass:"uni-pagination-box"},[i("uni-pagination",{attrs:{"show-icon":!0,"page-size":t.pageSize,current:t.pageCurrent,total:t.total},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.change.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"uni-group"},[i("v-uni-button",{staticClass:"uni-button",attrs:{size:"mini",type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.gotoPage("加入购物车")}}},[t._v("加入购物车")]),i("v-uni-button",{staticClass:"uni-button",attrs:{size:"mini",type:"warn"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.gotoPage("quxiao")}}},[t._v("取消")])],1)],1)],1),i("v-uni-view",{staticClass:"uni-container"},[i("v-uni-view",{staticClass:"uni-group"},[i("v-uni-button",{staticClass:"uni-button",attrs:{size:"mini",type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.gotoPage("结算订单")}}},[t._v("结算订单")]),i("v-uni-button",{staticClass:"uni-button",attrs:{size:"mini",type:"warn"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.gotoPage("取消订单")}}},[t._v("取消订单")])],1),i("uni-table",{attrs:{loading:t.loading,border:!0,stripe:!0,type:"selection",emptyText:t.$t("common.empty")},on:{"selection-change":function(e){arguments[0]=e=t.$handleEvent(e),t.selectionChange2.apply(void 0,arguments)}}},[i("uni-tr",[i("uni-th",{attrs:{width:"40",align:"center"}},[t._v("ID")]),i("uni-th",{attrs:{width:"150",align:"center"}},[t._v("药名")]),i("uni-th",{attrs:{width:"80",align:"center"}},[t._v("库存")]),i("uni-th",{attrs:{width:"80",align:"center"}},[t._v("购买数量")]),i("uni-th",{attrs:{width:"80",align:"center"}},[t._v("单位")]),i("uni-th",{attrs:{width:"120",align:"center"}},[t._v("销售价")]),i("uni-th",{staticStyle:{color:"#007408"},attrs:{width:"80",align:"center"}},[t._v("实际销售价")]),i("uni-th",{attrs:{width:"60",align:"center"}},[t._v("销售总价")]),i("uni-th",{attrs:{width:"300",align:"center"}},[t._v("操作")])],1),t._l(t.tableData,(function(e,a){return i("uni-tr",{key:a},[i("uni-td",{attrs:{align:"center"}},[t._v(t._s(a+1))]),i("uni-td",{attrs:{align:"center"}},[t._v(t._s(e.name))]),i("uni-td",{attrs:{align:"center"}},[t._v(t._s(e.shuliang))]),i("uni-td",{attrs:{align:"center"}},[t._v(t._s(e.buy_shuliang))]),i("uni-td",{attrs:{align:"center"}},[t._v(t._s(e.danwei))]),i("uni-td",{attrs:{align:"center"}},[e.new_jiage?i("span",{staticStyle:{"text-decoration":"line-through"}},[t._v(t._s(e.xiaoshou_jia))]):i("span",[t._v(t._s(e.xiaoshou_jia))])]),i("uni-td",{staticStyle:{color:"#007408"},attrs:{align:"center"}},[t._v(t._s(e.new_jiage))]),i("uni-td",{attrs:{align:"center"}},[e.new_jiage?i("span",[t._v(t._s(e.new_jiage*e.buy_shuliang))]):i("span",[t._v(t._s(e.xiaoshou_jia*e.buy_shuliang))])]),i("uni-td",[i("v-uni-view",{staticClass:"uni-group"},[i("v-uni-button",{staticClass:"uni-button",attrs:{size:"mini",type:"primary"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.gotoPage("editJiage",e,a)}}},[t._v("修改销售价格")]),i("v-uni-button",{staticClass:"uni-button",attrs:{size:"mini",type:"primary"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.gotoPage("editShuliang",e,a)}}},[t._v("修改销售数量")]),i("v-uni-button",{staticClass:"uni-button",attrs:{size:"mini",type:"warn"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.gotoPage("del",e,a)}}},[t._v(t._s(t.$t("common.button.delete")))]),i("v-uni-button",{staticClass:"uni-button",attrs:{size:"mini",type:"warn"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.gotoPage("detail",e)}}},[t._v("详情")])],1)],1)],1)}))],2),i("v-uni-view",{staticClass:"uni-pagination-box"},[i("uni-pagination",{attrs:{"show-icon":!0,"page-size":t.pageSize,current:t.pageCurrent,total:t.total},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.change.apply(void 0,arguments)}}})],1)],1),i("uni-popup",{ref:"boxNumberBox",attrs:{type:"dialog"}},[i("uni-popup-dialog",{ref:"inputClose",attrs:{beforeClose:!0,mode:"input",title:"销售数量",value:"1",placeholder:"请输入要核销的盒数"},on:{confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.dialogInputConfirm.apply(void 0,arguments)},close:function(e){arguments[0]=e=t.$handleEvent(e),t.closeFn("boxNumberBox")}}})],1),i("uni-popup",{ref:"editNumberBox",attrs:{type:"dialog"}},[i("uni-popup-dialog",{ref:"inputClose",attrs:{beforeClose:!0,mode:"input",title:"修改数量",value:t.boxNumberValue,placeholder:"请输入要修改的盒数"},on:{confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmFn("editNumberConfirm",e)},close:function(e){arguments[0]=e=t.$handleEvent(e),t.closeFn("editNumberBox")}}})],1),i("uni-popup",{ref:"ercimimaBox",attrs:{type:"dialog"}},[i("uni-popup-dialog",{ref:"inputClose",attrs:{beforeClose:!0,mode:"pwd",title:"管理员密码",value:"",placeholder:"请输入管理员密码"},on:{confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmFn("ercimimaBox",e)},close:function(e){arguments[0]=e=t.$handleEvent(e),t.closeFn("ercimimaBox")}}})],1),i("uni-popup",{ref:"editJiageBox",attrs:{type:"dialog"}},[i("uni-popup-dialog",{ref:"inputClose",attrs:{beforeClose:!0,mode:"input",title:"请输入要修改的销售价格",value:"",placeholder:"请输入要修改的销售价格"},on:{confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmFn("editJiageBox",e)},close:function(e){arguments[0]=e=t.$handleEvent(e),t.closeFn("editJiageBox")}}})],1),i("uni-popup",{ref:"jiesuanPopupBox",attrs:{type:"message","mask-click":!1}},[i("uni-grid",{attrs:{column:5,highlight:!0},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.jiesuanPopupPayChange.apply(void 0,arguments)}}},t._l(t.jiesuanPopupList,(function(e,a){return i("uni-grid-item",{key:a,attrs:{index:a}},[i("v-uni-view",{staticClass:"grid-item-box",staticStyle:{"background-color":"#fff"}},[i("v-uni-view",{staticClass:"iconfont",class:e.iconSrc}),i("v-uni-text",{staticClass:"text"},[t._v(t._s(e.name))])],1)],1)})),1),i("v-uni-button",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.close("jiesuanPopupBox")}}},[t._v("关闭购物车")])],1),i("uni-popup",{ref:"zhifuPopup",attrs:{type:"center"}},[i("v-uni-view",{staticClass:"zhifuPopupDiv"},[i("v-uni-view",{staticClass:"title"},[t._v(t._s(t.baseFormData.zhifufangshi))]),i("v-uni-view",{staticClass:"formDataDiv"},[i("uni-forms",{ref:"baseForm",attrs:{modelValue:t.baseFormData,"label-width":80}},[i("uni-forms-item",{attrs:{label:"方式",required:!0}},[i("uni-easyinput",{attrs:{disabled:!0},model:{value:t.baseFormData.zhifufangshi,callback:function(e){t.$set(t.baseFormData,"zhifufangshi",e)},expression:"baseFormData.zhifufangshi"}})],1),i("uni-forms-item",{attrs:{label:"应收",required:!0}},[i("uni-easyinput",{attrs:{disabled:!0},model:{value:t.baseFormData.yingshou,callback:function(e){t.$set(t.baseFormData,"yingshou",e)},expression:"baseFormData.yingshou"}})],1),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"现金支付"==t.baseFormData.title,expression:"baseFormData.title == '现金支付'"}]},[i("uni-forms-item",{attrs:{label:"实收",required:!0}},[i("uni-easyinput",{attrs:{type:"number"},model:{value:t.baseFormData.shishou,callback:function(e){t.$set(t.baseFormData,"shishou",e)},expression:"baseFormData.shishou"}})],1),i("uni-forms-item",{attrs:{label:"找零"}},[i("uni-easyinput",{attrs:{disabled:!0},model:{value:t.baseFormData.zhaoling,callback:function(e){t.$set(t.baseFormData,"zhaoling",e)},expression:"baseFormData.zhaoling"}})],1)],1),i("uni-forms-item",{attrs:{label:"说明"}},[i("uni-easyinput",{model:{value:t.baseFormData.shuoming,callback:function(e){t.$set(t.baseFormData,"shuoming",e)},expression:"baseFormData.shuoming"}})],1)],1),i("v-uni-view",{staticClass:"uni-group"},[i("v-uni-button",{staticClass:"uni-button",attrs:{size:"mini",type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.gotoPage("结算")}}},[t._v("结算")]),i("v-uni-button",{staticClass:"uni-button",attrs:{size:"mini",type:"warn"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.gotoPage("重新选择")}}},[t._v("重新选择支付方式")])],1)],1)],1)],1)],1)},s=[]},"4d90":function(t,e,i){"use strict";var a=i("23e7"),n=i("0ccb").start,s=i("9a0c");a({target:"String",proto:!0,forced:s},{padStart:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},"520c":function(t,e,i){"use strict";(function(t){function a(t,e){if(0===arguments.length||!t)return null;var i,a=e||"{y}-{m}-{d} {h}:{i}:{s}";"object"===typeof t?i=t:("string"===typeof t&&(t=/^[0-9]+$/.test(t)?parseInt(t):t.replace(new RegExp(/-/gm),"/")),"number"===typeof t&&10===t.toString().length&&(t*=1e3),i=new Date(t));var n={y:i.getFullYear(),m:i.getMonth()+1,d:i.getDate(),h:i.getHours(),i:i.getMinutes(),s:i.getSeconds(),a:i.getDay()},s=a.replace(/{([ymdhisa])+}/g,(function(t,e){var i=n[e];return"a"===e?["日","一","二","三","四","五","六"][i]:i.toString().padStart(2,"0")}));return s}function n(e,i,n,s){var o=a(new Date,"{y}-{m}-{d} {h}:{i}:{s}"),u=uni.getStorageSync("lastUsername"),r={type:"addYaoPinJournal",people:u,time:o,operationType:e,shuoming:i,yaopinID:n,addKucunNum:s};t.callFunction({name:"a-yaopin",data:r,success:function(t){},fail:function(t){}})}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:+new Date,e=new Date(t+288e5),i=e.toJSON().substr(0,19).replace("T"," ");return i}i("f4b3"),i("d3b7"),i("e25e"),i("4d63"),i("ac1f"),i("25f0"),i("4d90"),i("5319"),i("bf19"),Object.defineProperty(e,"__esModule",{value:!0}),e.parseTime=a,e.addYaoPinJournal=n,e.timeFn=s}).call(this,i("a9ff")["default"])},"9a0c":function(t,e,i){var a=i("342f");t.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(a)},b1f3:function(t,e,i){"use strict";var a=i("d639"),n=i.n(a);n.a},d639:function(t,e,i){var a=i("0d7a");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("181ebac9",a,!0,{sourceMap:!1,shadowMode:!1})},db69:function(t,e,i){"use strict";i.r(e);var a=i("fa97"),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,(function(){return a[t]}))}(s);e["default"]=n.a},e1a7:function(t,e,i){"use strict";i.r(e);var a=i("1469"),n=i("db69");for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);i("b1f3");var o,u=i("f0c5"),r=Object(u["a"])(n["default"],a["b"],a["c"],!1,null,"59229be8",null,!1,a["a"],o);e["default"]=r.exports},fa97:function(t,e,i){"use strict";(function(t){var a=i("4ea4");i("99af"),i("c740"),i("4160"),i("a434"),i("f4b3"),i("a9e3"),i("ac1f"),i("5319"),i("159b"),i("bf19"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("2909")),s=a(i("5530")),o=i("520c"),u=i("26cb"),r={data:function(){return{searchVal:"",popupTableData:[],tableData:[],pageSize:10,pageCurrent:1,total:0,loading:!1,selectedInd:"",selectedList:[],boxNumberValue:1,editNumberBoxInd:"",clickListIndex:"",jiesuanPopupList:[{name:"现金支付",id:"1",iconSrc:"icon-zhifu"},{name:"医保卡支付",id:"2",iconSrc:"icon-shuaqiazhifu_huaban"},{name:"微信支付",id:"3",iconSrc:"icon-weixinzhifu"},{name:"支付宝支付",id:"4",iconSrc:"icon-zhifubao"},{name:"其它方式",id:"5",iconSrc:"icon-zhifu1"}],baseFormData:{zhifufangshi:"",yingshou:0,shishou:0,zhaoling:0,shuoming:"",buy_shuliang:0,new_jiage:"",addPeople:"",addTime:"",xiaoshouPeople:"",xiaoshouTime:"",dingdanID:""}}},computed:(0,s.default)((0,s.default)((0,s.default)((0,s.default)({},(0,u.mapState)("app",["appName"])),(0,u.mapState)("app",["routes"])),(0,u.mapState)("user",["userInfo"])),(0,u.mapState)("error",["logs"])),watch:{"baseFormData.shishou":{handler:function(t,e){this.baseFormData.zhaoling=Number(t)-Number(this.baseFormData.yingshou)}}},onLoad:function(){this.selectedInd="",this.selectedList=[]},methods:{gotoPage:function(t,e,i){switch(this.clickListIndex=i,t){case"加入购物车":0==this.selectedList.length?uni.showToast({title:"请最少选择一个药品进行结算",icon:"error"}):this.selectedList.length>1?uni.showToast({title:"你只能一次选择一个药品进行结算",icon:"error"}):this.$refs.boxNumberBox.open();break;case"quxiao":this.close();break;case"del":this.tableData.splice(i,1);break;case"结算订单":this.countFn(),this.addDingdanList(),this.$refs.jiesuanPopupBox.open();break;case"取消订单":this.tableData=[],baseFormData={zhifufangshi:"",yingshou:0,shishou:0,zhaoling:0,shuoming:"",buy_shuliang:0,new_jiage:"",addPeople:"",addTime:"",xiaoshouPeople:"",xiaoshouTime:"",dingdanID:""};break;case"结算":var a=/^-?[0-9]/;"现金支付"==this.baseFormData.title&&(a.test(this.baseFormData.zhaoling)&&a.test(this.baseFormData.yingshou)?this.baseFormData.zhaoling<0?uni.showToast({title:"请确认找零是否正确",icon:"error"}):this.jiesuanFn():uni.showToast({title:"数据有误，请重新操作一遍",icon:"error"})),this.jiesuanFn();break;case"重新选择":this.$refs.zhifuPopup.close();break;case"editJiage":this.$refs.ercimimaBox.open();break;case"editShuliang":this.$refs.editNumberBox.open(),this.boxNumberValue=this.tableData[i].buy_shuliang;break;default:break}},close:function(t){"jiesuanPopupBox"==t&&uni.navigateTo({url:"/pages/xiaoshou/dingdan/dingdan"}),this.selectedList=[],this.selectedInd="",this.$refs.popup.close()},selectionChange:function(t){this.selectedInd=t.detail.index,this.selectedList.push(this.popupTableData[t.detail.index])},selectionChange2:function(t){},dialogInputConfirm:function(t){var e=this,i=/^[0-9]/;if(i.test(t))if(Number(t)>Number(this.selectedList[0].shuliang))uni.showToast({title:"库存不够，请联系入库员添加",icon:"error"});else if(this.tableData.length>0){var a=this.tableData.findIndex((function(t){return t._id==e.selectedList[0]._id}));-1!=a?this.tableData[a].buy_shuliang=Number(this.tableData[a].buy_shuliang)+Number(t):(this.$set(this.selectedList[0],"buy_shuliang",t),this.tableData=this.tableData.concat(this.selectedList[0])),this.closeFn("all")}else this.selectedList.buy_shuliang=t,this.$set(this.selectedList[0],"buy_shuliang",t),this.tableData=this.tableData.concat(this.selectedList),this.closeFn("all");else uni.showToast({title:"请输入纯数字",icon:"error"})},closeFn:function(t){switch(t){case"ercimimaBox":this.$refs.ercimimaBox.close();break;case"boxNumberBox":this.$refs.boxNumberBox.close(),this.selectedInd="",this.selectedList=[];break;case"editJiageBox":this.$refs.editJiageBox.close();break;case"editNumberBox":this.$refs.editNumberBox.close();break;case"all":this.$refs.ercimimaBox.close(),this.$refs.boxNumberBox.close(),this.$refs.editJiageBox.close(),this.$refs.zhifuPopup.close(),this.$refs.jiesuanPopupBox.close(),this.$refs.popup.close(),this.selectedInd="",this.selectedList=[];break;default:break}},confirmFn:function(t,e){switch(t){case"ercimimaBox":"admin"==e?(this.closeFn("ercimimaBox"),this.$refs.editJiageBox.open()):uni.showToast({title:"管理员密码错误",icon:"error"});break;case"editJiageBox":this.$set(this.tableData[this.clickListIndex],"new_jiage",Number(e)),this.closeFn("editJiageBox");break;case"editNumberConfirm":Number(e)>Number(this.tableData[this.clickListIndex].shuliang)?uni.showToast({title:"库存不够，请联系入库员添加",icon:"error"}):(this.$set(this.tableData[this.clickListIndex],"buy_shuliang",Number(e)),this.closeFn("editNumberBox"));break;default:break}},countFn:function(){var t=0,e=0,i=[];this.tableData.forEach((function(a){var n={};t+=Number(a.new_jiage?a.new_jiage:a.xiaoshou_jia)*Number(a.buy_shuliang),e+=Number(a.buy_shuliang),n.yaopinID=a._id,n.buy_shuliang=a.buy_shuliang,n.new_jiage=a.new_jiage?a.new_jiage:a.xiaoshou_jia,n.zongjia=Number(n.new_jiage)*Number(n.buy_shuliang),i.push(n)})),this.baseFormData.yingshou=t,this.baseFormData.buy_shuliang=e,this.dingdanList=i},jiesuanFn:function(){var e=this;this.baseFormData.xiaoshouPeople=this.userInfo.username,this.baseFormData.xiaoshouTime=(0,o.timeFn)();var i=(0,s.default)((0,s.default)({type:"addDingdan"},this.baseFormData),{},{zhonglei:this.tableData.length,lsit:(0,n.default)(this.tableData),isFinish:1});""==this.baseFormData.dingdanID?i.type="addDingdan":i.type="upDateDingdan",t.callFunction({name:"a-dingdan",data:i,success:function(t){var i=t;uni.showModal({title:"提示",content:"结算成功",showCancel:!1,success:function(t){i.result.id;t.confirm?(e.closeFn("all"),e.baseFormData={zhifufangshi:"",yingshou:0,shishou:0,zhaoling:0,shuoming:"",buy_shuliang:0,new_jiage:"",addPeople:"",addTime:"",xiaoshouPeople:"",xiaoshouTime:"",dingdanID:""}):t.cancel}})},fail:function(t){}})},addDingdanList:function(){var e=this;this.baseFormData.addPeople=this.userInfo.username,this.baseFormData.addTime=(0,o.timeFn)();var i=(0,s.default)((0,s.default)({},this.baseFormData),{},{zhonglei:this.tableData.length,list:this.tableData,isFinish:0});""==this.baseFormData.dingdanID?i.type="addDingdan":i.type="upDateDingdan",t.callFunction({name:"a-dingdan",data:i,success:function(t){""==e.baseFormData.dingdanID&&(e.baseFormData.dingdanID=t.result.addDingdan.id)},fail:function(t){}})},addDingdanXQ:function(e){for(var i=this.tableData,a=0;a<i.length;a++)i[a].dingdanID=this.baseFormData.dingdanID;var n={type:"addDingdanXQ",list:i};t.callFunction({name:"a-dingdan",data:n,success:function(t){},fail:function(t){}})},jiesuanPopupPayChange:function(t){var e,i;e=t.detail.index,i=this.jiesuanPopupList[e].name,this.baseFormData.title=i,this.baseFormData.zhifufangshi=i,this.$refs.zhifuPopup.open()},searchFn:function(){var e=this,i={value:this.searchVal,type:"getListByID"};t.callFunction({name:"a-xiaoshou",data:i,success:function(t){e.$refs.popup.open(),e.popupTableData=t.result.data},fail:function(t){}})},timeFn:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:+new Date,e=new Date(t+288e5),i=e.toJSON().substr(0,19).replace("T"," ");return i}}};e.default=r}).call(this,i("a9ff")["default"])}}]);